<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test BookingFix - Donn√©es Multiples</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; line-height: 1.6; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 8px; }
        .success { background-color: #d4edda; border-color: #c3e6cb; }
        .error { background-color: #f8d7da; border-color: #f5c6cb; }
        .info { background-color: #d1ecf1; border-color: #bee5eb; }
        button { padding: 10px 20px; margin: 5px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background: #0056b3; }
        pre { background: #f8f9fa; padding: 10px; border-radius: 4px; overflow-x: auto; font-size: 12px; }
        .step { margin: 10px 0; padding: 10px; background: #f8f9fa; border-radius: 4px; }
        .completed { background: #d4edda; }
        .warning { background: #fff3cd; }
    </style>
</head>
<body>
    <h1>üß™ Test BookingFix - Donn√©es Multiples</h1>
    
    <div class="test-section info">
        <h3>üìã Corrections Apport√©es</h3>
        <div class="step completed">
            <strong>‚úÖ Bouton fixe supprim√© :</strong> Plus de bouton sticky en bas de page mobile
        </div>
        <div class="step completed">
            <strong>‚úÖ Services multiples :</strong> Affichage correct des 2 prestations s√©lectionn√©es
        </div>
        <div class="step completed">
            <strong>‚úÖ Donn√©es dynamiques :</strong> Plus de donn√©es en dur, tout est r√©cup√©r√© dynamiquement
        </div>
        <div class="step completed">
            <strong>‚úÖ "Pro" ‚Üí "Professionnel" :</strong> Terminologie corrig√©e
        </div>
        <div class="step completed">
            <strong>‚úÖ Nom professionnel :</strong> Affichage dynamique du professionnel choisi
        </div>
    </div>

    <div class="test-section">
        <h3>üîó 1. Simuler Donn√©es Multiples</h3>
        <button onclick="simulateMultiServices()">Simuler 2 Services</button>
        <div id="multi-services-result"></div>
    </div>

    <div class="test-section">
        <h3>üîó 2. V√©rifier Donn√©es Session</h3>
        <button onclick="checkSessionData()">V√©rifier SessionStorage</button>
        <div id="session-data-result"></div>
    </div>

    <div class="test-section">
        <h3>üîó 3. Test Page BookingFix</h3>
        <button onclick="openBookingFix()">Ouvrir BookingFix</button>
        <div id="booking-fix-result"></div>
    </div>

    <div class="test-section">
        <h3>üîó 4. Test Flux Complet</h3>
        <button onclick="testCompleteFlow()">Test Flux Complet</button>
        <div id="complete-flow-result"></div>
    </div>

    <script>
        const FRONTEND_URL = 'http://localhost:5173';

        function simulateMultiServices() {
            const resultDiv = document.getElementById('multi-services-result');
            
            // Simuler des donn√©es de services multiples
            const multiServicesData = {
                selectedServices: [
                    { 
                        id: "service1", 
                        name: "Coupe + Brushing", 
                        price: 45, 
                        duration: 60 
                    },
                    { 
                        id: "service2", 
                        name: "Coloration compl√®te", 
                        price: 80, 
                        duration: 90 
                    }
                ],
                totalPrice: 125,
                totalDuration: 150,
                serviceCount: 2,
                selectedDate: "Lundi 20 janvier 2025",
                selectedTime: "14:00",
                professionalName: "Marie Dubois",
                professionalId: "1759862715734",
                salonId: "15228957-f9f1-4f2d-82ac-ecba9f33c922",
                salonSlug: "salon-15228957"
            };
            
            // Stocker les donn√©es dans sessionStorage
            sessionStorage.setItem('preBookingData', JSON.stringify(multiServicesData));
            
            resultDiv.innerHTML = `
                <div class="success">
                    <h4>‚úÖ Donn√©es Multiples Simul√©es</h4>
                    <div class="step completed">
                        <strong>Services :</strong> ${multiServicesData.selectedServices.length} prestations
                    </div>
                    <div class="step completed">
                        <strong>Total :</strong> ${multiServicesData.totalPrice}‚Ç¨
                    </div>
                    <div class="step completed">
                        <strong>Dur√©e :</strong> ${multiServicesData.totalDuration} min
                    </div>
                    <div class="step completed">
                        <strong>Professionnel :</strong> ${multiServicesData.professionalName}
                    </div>
                    <div class="step completed">
                        <strong>Date :</strong> ${multiServicesData.selectedDate} √† ${multiServicesData.selectedTime}
                    </div>
                    <pre>${JSON.stringify(multiServicesData, null, 2)}</pre>
                </div>
            `;
        }

        function checkSessionData() {
            const resultDiv = document.getElementById('session-data-result');
            const preBookingData = sessionStorage.getItem('preBookingData');
            
            if (preBookingData) {
                const parsed = JSON.parse(preBookingData);
                resultDiv.innerHTML = `
                    <div class="success">
                        <h4>‚úÖ Donn√©es Session Trouv√©es</h4>
                        <div class="step completed">
                            <strong>Services :</strong> ${parsed.selectedServices?.length || 0} prestations
                        </div>
                        <div class="step completed">
                            <strong>Total :</strong> ${parsed.totalPrice || 0}‚Ç¨
                        </div>
                        <div class="step completed">
                            <strong>Professionnel :</strong> ${parsed.professionalName || 'Non d√©fini'}
                        </div>
                        <pre>${JSON.stringify(parsed, null, 2)}</pre>
                    </div>
                `;
            } else {
                resultDiv.innerHTML = `
                    <div class="error">
                        <h4>‚ùå Aucune Donn√©e Session</h4>
                        <p>Veuillez d'abord simuler des donn√©es multiples</p>
                    </div>
                `;
            }
        }

        function openBookingFix() {
            const resultDiv = document.getElementById('booking-fix-result');
            resultDiv.innerHTML = `
                <div class="info">
                    <h4>üîó Ouverture Page BookingFix</h4>
                    <div class="step completed">
                        <strong>URL :</strong> ${FRONTEND_URL}/booking-fix
                    </div>
                    <div class="step completed">
                        <strong>V√©rifications :</strong>
                        <ol>
                            <li>‚úÖ Bouton fixe mobile supprim√©</li>
                            <li>‚úÖ 2 prestations affich√©es</li>
                            <li>‚úÖ Total correct (125‚Ç¨)</li>
                            <li>‚úÖ Nom professionnel dynamique</li>
                            <li>‚úÖ Pas de donn√©es en dur</li>
                        </ol>
                    </div>
                </div>
            `;
            
            // Ouvrir la page booking-fix
            window.open(`${FRONTEND_URL}/booking-fix`, '_blank');
        }

        function testCompleteFlow() {
            const resultDiv = document.getElementById('complete-flow-result');
            resultDiv.innerHTML = `
                <div class="info">
                    <h4>üîÑ Test Flux Complet</h4>
                    <div class="step completed">
                        <strong>1. Page Salon :</strong> ${FRONTEND_URL}/salon/salon-15228957
                    </div>
                    <div class="step completed">
                        <strong>2. S√©lection Services :</strong> Multi-s√©lection (2 services)
                    </div>
                    <div class="step completed">
                        <strong>3. Choix Date/Heure :</strong> Cr√©neaux disponibles
                    </div>
                    <div class="step completed">
                        <strong>4. Page BookingFix :</strong> Affichage optimis√© des 2 services
                    </div>
                    <div class="step completed">
                        <strong>5. Paiement :</strong> Stripe int√©gr√©
                    </div>
                    <div class="step completed">
                        <strong>6. Confirmation :</strong> Rendez-vous sauvegard√©
                    </div>
                </div>
            `;
            
            // Ouvrir le flux complet
            window.open(`${FRONTEND_URL}/salon/salon-15228957`, '_blank');
        }

        // Auto-test au chargement
        window.onload = function() {
            console.log('üß™ Test BookingFix donn√©es multiples charg√©');
            
            // V√©rifier si des donn√©es existent d√©j√†
            const existingData = sessionStorage.getItem('preBookingData');
            if (existingData) {
                console.log('üìã Donn√©es existantes trouv√©es:', JSON.parse(existingData));
            }
        };
    </script>
</body>
</html>


