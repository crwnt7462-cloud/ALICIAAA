<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Corrections Finales Booking</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; line-height: 1.6; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 8px; }
        .success { background-color: #d4edda; border-color: #c3e6cb; }
        .error { background-color: #f8d7da; border-color: #f5c6cb; }
        .info { background-color: #d1ecf1; border-color: #bee5eb; }
        button { padding: 10px 20px; margin: 5px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background: #0056b3; }
        pre { background: #f8f9fa; padding: 10px; border-radius: 4px; overflow-x: auto; font-size: 12px; }
        .step { margin: 10px 0; padding: 10px; background: #f8f9fa; border-radius: 4px; }
        .completed { background: #d4edda; }
        .warning { background: #fff3cd; }
        .preview { background: #e9ecef; padding: 15px; border-radius: 8px; margin: 10px 0; }
    </style>
</head>
<body>
    <h1>üß™ Test Corrections Finales Booking</h1>
    
    <div class="test-section info">
        <h3>üìã Corrections Apport√©es</h3>
        <div class="step completed">
            <strong>‚úÖ Suppression affichage redondant :</strong> Tarif total supprim√© du r√©sum√© principal
        </div>
        <div class="step completed">
            <strong>‚úÖ Service URL ajout√© automatiquement :</strong> Service s√©lectionn√© via URL ajout√© aux selectedServices
        </div>
        <div class="step completed">
            <strong>‚úÖ Bouton violet :</strong> "J'ai d√©j√† un compte" maintenant violet comme la page d'accueil
        </div>
        <div class="step completed">
            <strong>‚úÖ Logique d'acompte :</strong> Affichage d√©taill√© sous le professionnel uniquement
        </div>
    </div>

    <div class="test-section">
        <h3>üîó 1. Test Service URL + Services Multiples</h3>
        <button onclick="testUrlServicePlusMultiple()">Simuler Service URL + Services Multiples</button>
        <div id="url-plus-multiple-result"></div>
    </div>

    <div class="test-section">
        <h3>üîó 2. Test Affichage Nettoy√©</h3>
        <button onclick="testCleanDisplay()">Simuler Affichage Nettoy√©</button>
        <div id="clean-display-result"></div>
    </div>

    <div class="test-section">
        <h3>üîó 3. Test Bouton Violet</h3>
        <button onclick="testVioletButton()">V√©rifier Style Bouton</button>
        <div id="violet-button-result"></div>
    </div>

    <div class="test-section">
        <h3>üîó 4. Test Page BookingFix</h3>
        <button onclick="openBookingFix()">Ouvrir BookingFix</button>
        <div id="booking-fix-result"></div>
    </div>

    <script>
        const FRONTEND_URL = 'http://localhost:5173';

        function testUrlServicePlusMultiple() {
            const resultDiv = document.getElementById('url-plus-multiple-result');
            
            const urlServicePlusMultipleData = {
                selectedServices: [
                    { 
                        id: "1759861618425.438", 
                        name: "testtttt gratuit üêÄ", 
                        price: 0, 
                        duration: 30 
                    },
                    { 
                        id: "service2", 
                        name: "Coloration compl√®te", 
                        price: 80, 
                        duration: 90 
                    },
                    { 
                        id: "service3", 
                        name: "Manucure", 
                        price: 25, 
                        duration: 30 
                    }
                ],
                totalPrice: 105,
                totalDuration: 150,
                serviceCount: 3,
                selectedDate: "Lundi 20 janvier 2025",
                selectedTime: "14:00",
                professionalName: "Marie Dubois",
                professionalId: "1759862715734",
                salonId: "15228957-f9f1-4f2d-82ac-ecba9f33c922",
                salonSlug: "salon-15228957"
            };
            
            sessionStorage.setItem('preBookingData', JSON.stringify(urlServicePlusMultipleData));
            
            resultDiv.innerHTML = `
                <div class="success">
                    <h4>‚úÖ Service URL + Services Multiples Simul√©s</h4>
                    <div class="preview">
                        <strong>Affichage Attendu :</strong>
                        <ul>
                            <li><strong>3 prestations s√©lectionn√©es</strong> (titre)</li>
                            <li><strong>Liste des 3 services</strong> (1 gratuit via URL + 2 ajout√©s)</li>
                            <li><strong>Professionnel :</strong> Marie Dubois</li>
                            <li><strong>Montant total :</strong> 105,00 ‚Ç¨</li>
                            <li><strong>Acompte (50%) :</strong> 52,50 ‚Ç¨</li>
                            <li><strong>√Ä r√©gler aujourd'hui :</strong> 52,50 ‚Ç¨</li>
                            <li><strong>PAS de tarif redondant</strong> dans le r√©sum√© principal</li>
                        </ul>
                    </div>
                    <div class="step completed">
                        <strong>Services :</strong> ${urlServicePlusMultipleData.selectedServices.length} prestations
                    </div>
                    <div class="step completed">
                        <strong>Service URL :</strong> testtttt gratuit üêÄ (ajout√© automatiquement)
                    </div>
                    <div class="step completed">
                        <strong>Services Ajout√©s :</strong> Coloration + Manucure
                    </div>
                    <div class="step completed">
                        <strong>Prix Total :</strong> ${urlServicePlusMultipleData.totalPrice}‚Ç¨
                    </div>
                    <pre>${JSON.stringify(urlServicePlusMultipleData, null, 2)}</pre>
                </div>
            `;
        }

        function testCleanDisplay() {
            const resultDiv = document.getElementById('clean-display-result');
            
            resultDiv.innerHTML = `
                <div class="success">
                    <h4>‚úÖ Affichage Nettoy√©</h4>
                    <div class="preview">
                        <strong>V√©rifications :</strong>
                        <ul>
                            <li>‚úÖ <strong>Pas de tarif redondant</strong> dans le r√©sum√© principal</li>
                            <li>‚úÖ <strong>D√©tails sous professionnel uniquement</strong></li>
                            <li>‚úÖ <strong>Montant total</strong> affich√© sous le professionnel</li>
                            <li>‚úÖ <strong>Acompte calcul√©</strong> affich√© sous le professionnel</li>
                            <li>‚úÖ <strong>"√Ä r√©gler aujourd'hui"</strong> affich√© sous le professionnel</li>
                            <li>‚úÖ <strong>Interface plus propre</strong> sans duplication</li>
                        </ul>
                    </div>
                    <div class="step completed">
                        <strong>R√©sum√© Principal :</strong> Seulement les prestations et d√©tails RDV
                    </div>
                    <div class="step completed">
                        <strong>Section Professionnel :</strong> Montant total + acompte + √† r√©gler
                    </div>
                    <div class="step completed">
                        <strong>Interface :</strong> Plus claire et organis√©e
                    </div>
                </div>
            `;
        }

        function testVioletButton() {
            const resultDiv = document.getElementById('violet-button-result');
            
            resultDiv.innerHTML = `
                <div class="success">
                    <h4>‚úÖ Bouton Violet V√©rifi√©</h4>
                    <div class="preview">
                        <strong>Style Attendu :</strong>
                        <ul>
                            <li>‚úÖ <strong>Couleur de fond :</strong> bg-violet-600</li>
                            <li>‚úÖ <strong>Couleur au survol :</strong> hover:bg-violet-700</li>
                            <li>‚úÖ <strong>Texte :</strong> text-white</li>
                            <li>‚úÖ <strong>Style :</strong> Identique √† la page d'accueil</li>
                            <li>‚úÖ <strong>Pas de variant="outline"</strong></li>
                        </ul>
                    </div>
                    <div class="step completed">
                        <strong>Bouton :</strong> "J'ai d√©j√† un compte - Se connecter"
                    </div>
                    <div class="step completed">
                        <strong>Couleur :</strong> Violet (#7c3aed) au lieu de blanc
                    </div>
                    <div class="step completed">
                        <strong>Style :</strong> Plein au lieu d'outline
                    </div>
                </div>
            `;
        }

        function openBookingFix() {
            const resultDiv = document.getElementById('booking-fix-result');
            resultDiv.innerHTML = `
                <div class="info">
                    <h4>üîó Ouverture Page BookingFix</h4>
                    <div class="step completed">
                        <strong>URL :</strong> ${FRONTEND_URL}/booking-fix
                    </div>
                    <div class="step completed">
                        <strong>V√©rifications :</strong>
                        <ol>
                            <li>‚úÖ <strong>Toutes les prestations</strong> affich√©es (URL + ajout√©es)</li>
                            <li>‚úÖ <strong>Pas de tarif redondant</strong> dans le r√©sum√© principal</li>
                            <li>‚úÖ <strong>D√©tails financiers</strong> sous le professionnel uniquement</li>
                            <li>‚úÖ <strong>Bouton violet</strong> "J'ai d√©j√† un compte"</li>
                            <li>‚úÖ <strong>Interface propre</strong> et organis√©e</li>
                            <li>‚úÖ <strong>Logique d'acompte</strong> correcte</li>
                        </ol>
                    </div>
                </div>
            `;
            
            // Ouvrir la page booking-fix
            window.open(`${FRONTEND_URL}/booking-fix`, '_blank');
        }

        // Auto-test au chargement
        window.onload = function() {
            console.log('üß™ Test corrections finales booking charg√©');
            
            // V√©rifier si des donn√©es existent d√©j√†
            const existingData = sessionStorage.getItem('preBookingData');
            if (existingData) {
                console.log('üìã Donn√©es existantes trouv√©es:', JSON.parse(existingData));
            }
        };
    </script>
</body>
</html>

